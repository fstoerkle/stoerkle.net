{
  "name": "blacksmith",
  "version": "1.1.3",
  "description": "A static site generator built with Node.js, Plates, and Marked.",
  "author": {
    "name": "Nodejitsu Inc.",
    "email": "info@nodejitsu.com"
  },
  "dependencies": {
    "async": "0.1.x",
    "flatiron": "0.3.0",
    "highlight.js": "7.3.0",
    "marked": "0.2.x",
    "mkdirp": "0.0.x",
    "plates": "0.4.x",
    "timespan": "2.2.x"
  },
  "bin": {
    "blacksmith": "bin/blacksmith"
  },
  "devDependencies": {
    "vows": "0.6.x"
  },
  "readme": "# blacksmith\n\nA generic static site generator built using `flatiron`, `plates`, and `marked`.\n\n* [Creating a site with Blacksmith](#creating-a-site-with-blacksmith)\n* [Components of a Blacksmith site](#components-of-a-blacksmith-site)\n  * [Site Settings](#site-settings)\n  * [Layouts](#layouts)\n  * [Pages](#pages)\n    * [All Page Options](#all-page-options)\n  * [Content](#content)\n    * [Specifying Metadata](#specifying-metadata)\n    * [Content Snippets](#content-snippets)\n    * [Code Highlighting](#code-highlighting)\n    * [Truncated Content](#truncated-content)\n  * [Partials](#partials)\n    * [Customizing Partials](#customizing-partials)\n    * [Metadata References](#metadata-references)\n    * [Conditional Metadata](#conditional-metadata)\n* [How does blacksmith render my Site?](#how-does-blacksmith-render-my-site)\n  * [Rendering Procedure](#rendering-procedure)\n  * [Rendering Data Structure](#rendering-data-structure)\n* [Tests](#tests)\n\n## Creating a site with `blacksmith` \n\nBlacksmith sites have a specific directory structure for storing the various parts of your site: settings, layout, partials, pages, and content. Content exists in two forms:\n\n* Markdown files that `blacksmith` will render.\n* Supporting content such as css and images.\n\nAll content will be rendered into `/public`. To render a blacksmith site:\n\n**Install Blacksmith**\n\n``` bash\n  $ npm install blacksmith -g\n```\n\n**Render a Site**\n\n``` bash\n  #\n  # Defaults to `cwd`\n  #\n  $ blacksmith /path/to/your/site\n```\n\nHere's an example of a simple blog that `blacksmith` would render. \n\n``` bash\n/site-name\n  #\n  # Settings for this blacksmith site.\n  #\n  .blacksmith\n  /content\n    #\n    # Actual Markdown content to render.\n    #\n    /posts\n      a-post.md\n      another-post.md\n  /layouts\n    #\n    # Layouts to use for pages. You can specify \n    # multiple layouts, but default.html is ... the default.\n    #\n    default.html\n  /metadata\n    #\n    # Metadata entities which can be reference in content metdata\n    #\n    /authors\n      author-name.json\n  /partials\n    #\n    # HTML for partials inside of pages\n    #\n    post.html\n    sidebar.html\n  /pages\n    #\n    # Metadata for rendering specific pages\n    #\n    index.json\n    post.json\n  /public\n    #\n    # Any additional files for viewing the site. All\n    # rendered HTML will be placed here. e.g.:\n    #\n    /css\n      styles.css\n    /img\n      favicon.png\n```\n\n## Components of a `blacksmith` site\n\nEach `blacksmith` site defines a hierarchical set of components which can be composed **to create any type of site you want!** A couple of examples:\n\n* A Blog\n* A Documentation Site\n* A Custom Splash Page or Content Site\n\nLets examine each of these components and where they are stored in your filesystem:\n\n### Site Settings\n\nThe settings for a given `blacksmith` site are stored in the `.blacksmith` file located in the root directory of your site. \n\n``` js\n  {\n    //\n    // Default Layout. Specifying a name here will cause Blacksmith to attempt to read\n    // /layouts/layout-name.json for rendering info. If no layout-name.json file is found\n    // blacksmith will use `/layouts/layout-name.html`\n    //\n    // Default: default\n    //\n    \"layout\": \"layout-name\"\n    \"pages\": {\n      //\n      // These settings will be used for all content in\n      // /content/posts\n      //\n      \"post\": {\n        \"layout\": \"custom-layout-for-posts\",\n        \"partials\": {\n          \"html-id\": \"additional-partials\",\n          \"another-id\": \"for-this-page-only\"\n        }\n      }\n    }\n  }\n```\n\nYou can define settings for all components of your site in the `.blacksmith` file or break them out into individual files within component directories. For example, the above example is equivalent to:\n\n**/.blacksmith**\n\n``` js\n  {\n    \"layout\": \"layout-name\"\n  }\n```\n\n**/pages/post.json**\n\n``` js\n {\n  \"layout\": \"custom-layout-for-posts\",\n  \"partials\": {\n    \"html-id\": \"additional-partials\",\n    \"another-id\": \"for-this-page-only\"\n  }\n}\n```\n\n### Layouts\n\nLayouts are fully-formed HTML files; **_they are the top of the rendering hierarchy._** All content will be inserted into a layout inside of the HTML element with the `id=\"content\"`. Lets look at the worlds simplest layout:\n\n``` html\n  <html>\n  <head>\n  \t<title>Simple Layout</title>\n  \t<link rel=\"stylesheet\" href=\"css/styles.css\">\n  </head>\n  <body>\n    <div id=\"content\">\n      <!-- All rendered content place here-->\n    </div>\n  </body>\n  </html>  \n```\n\nSettings for a layout may specified in your `.blacksmith` file or in `/layouts/layout-name.json`. Lets look at an example:\n\n**/layouts/layout-name.json**\n**NOTE: These properties is not yet supported. See [Roadmap](#roadmap) for more details.**\n\n``` js\n  {\n    //\n    // The \"template\" property specifies which HTML file within the /layouts directory\n    // to use when rendering this layout. In this way a single HTML file can be reused with \n    // different partials.\n    //\n    // If no template is specified then blacksmith will look for /layouts/layout-name.html\n    // when rendering.\n    //\n    \"template\": \"shared-layout.html\",\n    //\n    // The \"partials\" property specifies which HTML partial (or partials) to insert at a given\n    // id within the layout. These partials will be rendered with the metadata for a given\n    // individual page with content.\n    //\n    \"partials\": {\n      \"sidebar-container\": \"sidebar\",\n      //\n      // Multiple partials can be concatentated into a single HTML id.\n      //\n      \"multi-container\": [\"partial1\", \"partial2\"]\n    }\n  }\n```\n\n### Pages\n\n**Pages** allowed you to specify **what type of content** you wish to render and where to render it within a given layout. As with layouts, pages may specified in your `.blacksmith` file or in `/pages/page-name.json`. Lets look at two examples from our blog:\n\n**/pages/index.json**\n\nThis example of particular interest: **index.json will always be used to render index.html.** In the below example specifies that `blacksmith` should render a list of `post` content, which should be truncated, limited to a maximum of 20 posts. **Note: All lists are sorted descending by the date the content was created.**\n\n``` js\n  {\n    //\n    // The \"content\" property specifies what blacksmith should render\n    // inside the HTML element with id=\"content\"\n    //\n    \"content\": {\n      \"list\": \"post\",\n      \"truncate\": true,\n      \"limit\": 20\n    }\n  }\n```\n\n**/pages/post.json**\n\nThe rendering information for an individual post is much simpler than our `index.json`. By creating this file, `blacksmith` will:\n\n1. Render all Markdown files in `/content/posts` using the partial found at `/partials/post.html`.\n2. Render the partial found at `/partials/sidebar.html` with the metadata for each Markdown file in `/content/posts` and append it to the HTML element with id=\"content\"\n\n``` js\n  {\n    \"partials\": {\n      \"content\": \"sidebar\"\n    }\n  }\n```\n\nIt is important to take note of the convention:\n\n``` \n  Convention: By default, page content will be rendered in a partial of the same name by default. \n```\n\nAlternatively we could have specified a specific partial to use. If no partial is specified and the default partial is not found then **no metadata would be rendered** (in this case author name, date of post, etc).\n\n#### All Page Options\nA list of all options that can be specified in a `page.json` file are listed below:\n\n``` js\n  {\n    //\n    // Specifies the layout for the page. \n    // Default: Layout for the site.\n    //\n    \"layout\": \"custom-layout-for-page\",\n    \n    //\n    // Specifies a mapping of HTML ids to partial(s). If \"content\" is specified\n    // then it is appended after the rendered markdown content.\n    //\n    \"partials\": {\n      \"html-id\": \"partial-name\",\n      \"another-id\": [\"multiple-partials\"]\n    },\n    \n    //\n    // Case 1: Rendering content with a partial\n    //\n    \"content\": \"custom-partial\"\n    \n    //\n    // Case 2: Consolidating multiple content sources in a list.\n    //\n    \"content\": {\n      \"list\": \"post\",\n      \"truncate\": true,\n      \"limit\": 20\n    }\n  }\n```\n\n### Content\n\nIn `blacksmith`, \"content\" is raw Markdown and supporting files (e.g. images) located within the `/content` directory. Content for individual pages should be placed under `/content/page-name`. \n\nIn our example all content for the `post` page should be placed under `/content/posts`. It is important to take note of the convention:\n\n``` \n  Convention: Page names are always singular, but their content folder will always be plural.\n```\n\nThe content for an individual page may also be a directory where supporting files (such as images can be placed). For example if we wanted to create a post with images the directory structure would be:\n\n```\n/site-name\n  /content\n    /posts\n      /post-with-supporting-files\n        content.md\n        an-image.png\n        another-image.png\n        some-code.js\n```\n\nThe directory structure will be respected, but the `/content` prefix will be dropped. So the full-url for `an-image.png` would be `http://your-site.com/post-with-supporting-files/an-image.png`.\n\n#### Specifying Metadata\n\n**All metadata associated with content is stored within the individual Markdown files as link definitions prefixed with 'meta:'.** Because of a small limitation in the Markdown format you must use the following syntax to specify metadata:\n\n```\n  [meta:author] <> (Author Name)\n  [meta:title] <> (A Really Long Title Different from the Filename)\n  [meta:nested:values] <> (Are also supported)\n```\n\n#### Content Snippets\n\nIn large content pages it is often useful to have examples or references to other files to be inserted later in rendering. A classic example is **code samples in a blog post.** This is easy in `blacksmith` using **Content Snippets.** Consider the content:\n\n```\n  /content\n    /dir-post\n      index.md\n      whatever.js\n```\n\n``` markdown\n  This is a piece of markdown content to be rendered later. It has a reference to the file \"whatever.js\"\n  \n  <whatever.js>\n```\n\nIn this example `<whatever.js>` in `index.md` would be replaced with the contents of `/content/dir-post/whatever.js`. **Note: Only files with text extensions (.js, .rb, .txt, etc) less than 1MB will be inserted.**\n\n#### Code Highlighting\n\nBecause `blacksmith` uses `marked` we get the benefit of **Github Flavored Markdown** through `highlight.js`. By default code highlighting is enabled. All you need to do is add some CSS for your site. For example:\n\n``` css\n  pre {\n    border: 1px solid #e0ded3;\n    border-radius: 4px;\n    margin: 10px 10px 40px 10px;\n    padding: 10px;\n    background-color: #f0efe8;\n    overflow: auto;\n    font-size: 14px;\n    font-family: Consolas, \"Liberation Mono\", Courier, monospace;\n  }\n\n  code {\n    white-space: pre;\n    color: rgba(0,0,0, 1);\n  }\n\n  code .keyword              { font-weight: bold; color: #6089d4; }\n  code .string, code .regexp { color: green }\n  code .class, code .special { color: #6089d4 }\n  code .number               { color: red }\n  code .comment              { color: grey }\n```\n\n#### Truncated Content\n\nIt is necessary to truncate large content pages when rendering them within compilations (i.e. lists). This is supported by `blacksmith` with a special identifier in your Markdown files. For example:\n\n**/content/posts/dir-post/index.markdown**\n\n``` markdown\n  A simple post that is truncated with content snippets and metadata that is not used in the post.\n\n  ##!!truncate\n\n  <file1.js>\n  A second file reference with spaces\n  < file2.js  >\n\n  [meta:author]: <> (Charlie index)\n```\n\nWhen rendered in a page like `index.json` with `{ truncate: true }` only the content above `##!!truncate` will be rendered.\n\n### Partials\n\n**Partials** are HTML fragments which are inserted into a layout, a page, or another partial. **All partials are rendered with `plates`**.\n\n#### Default Metadata\n\n``` js\n  {\n    \"page-details\": {\n      \"author\": {\n        //\n        // Contents of /metdata/authors/author-name.json\n        //\n      },\n      \"href\": \"/full/path/to/page\",\n      \"date\": \"Fully qualified date page was published\",\n      \"files\": {\n        \"js\": [{ \"filename\": \"file1.js\", \"url\": \"/full/path/to/file1.js\" }],\n        \"img\": [{ \"filename\": \"img1.png\", \"url\": \"/full/path/to/img1.png\" }]\n      }\n    }\n  }\n```\n\n#### Customizing Partials\n\nAll metadata is placed into partials using a set of simple `plates` conventions. In the future it may be possible to customize these conventions but that is not currently planned.\n\n* _Map URL-like string keys to href=\"keyname\":_ `map.where('href').is(key).use(key).as('href');`\n* _Insert \"content\" into class=\"content\":_      `map.class('content').use('content').as('value');`\n* _Map string keys to class=\"keyname\":_         `map.class(key).use(key)`\n* _Map everything else to class=\"keyname\":_     `map.class(key).use(key);`\n* _Recursively map Array keys:_                 `exports.map(metadata[key][0], map);`\n* _Recursively map Object keys:_                `exports.map(metadata[key], map);`\n\n#### Conditional Metadata\n\nSome content should only exist in partials when a given key is present in the metadata. This is supported by `blacksmith` in the following way: _The keys in `remove` must be specified at the fully qualified path into an Object._\n\n**/partials/partial-name.json**\n\n``` js\n  {\n    \"remove\": {\n      \"page-details\": {\n        \"author\": [\"github\", \"twitter\"]\n      }\n    }\n  }\n```\n\nIn the corresponding HTML file for the partial any elements with \"class=if-[keyname]\" will be removed if the is no value for `keyname`. In the above example using the following template:\n\n**/partials/partial-name.html**\n\n``` html\n  <div class=\"page-details\">\n    <div class=\"author\">\n      <h3>About the author</h3>\n      <div class=\"name\">Author Name</div>\n      <div class=\"if-github\">\n        <a href=\"github-url\" class=\"github\">Author Github</a>\n      </div>\n      <div class=\"if-twitter\">\n        <a href=\"twitter-url\" class=\"twitter\">Author Twitter</a>  \n      </div>\n    </div>\n  </div>\n```\n\nand this set of metadata:\n\n``` js\n  {\n    \"page-details\": {\n      \"author\": {\n        \"name\": \"Charlie Robbins\",\n        \"github\": \"indexzero\",\n        \"github-url\": \"https://github.com/indexzero\"\n      }\n    }\n  }\n```\n\nThe output would be the following. **Notice how everything inside `if-twitter` has been removed.**\n\n``` html\n  <div class=\"page-details\">\n    <div class=\"author\">\n      <h3>About the author</h3>\n      <div class=\"name\">Charlie Robbins</div>\n      <div class=\"if-github\">\n        <a href=\"https://github.com/indexzero\" class=\"github\">indexzero</a>\n      </div>\n    </div>\n  </div>\n```\n\n#### Metadata References\n\nIt is useful when writing a content page to use a key to reference a larger section of metadata stored elsewhere. These other sections of metadata are called **metadata references** and are loaded by `blacksmith` from `/metadata`. For example:\n\n**/metdata/dogs/sparky-mcpherson.json**\n```\n  {\n    \"name\": \"sparky-mcpherson\",\n    \"breed\": \"labridoodle\",\n    \"color\": \"brown\",\n    \"age\": \"3\",\n    \"temperment\": \"friendly\"\n  }\n```\n\n**/content/posts/a-post.md**\n\n``` markdown\n  (... Rest of Content ...)  \n  [meta:dog] <> (Sparky McPherson)\n```\n\nWhen the content for this page finally gets rendered to a partial the metadata will not be `{ 'dog': 'sparky' }`, it will be the entire object stored in `/metadata/dogs/sparky.json`. By convention:\n\n```\n  Convention: For a given `key:value` blacksmith will lookup metadata references for the `value`\n  in the directory named with the plural of that `key`. \n```\n\nIn the above example the `key:value` pair is `dog:Sparky Mcpherson` so we attempt to lookup `sparky-mcpherson` within `/metadata/dogs/sparky-mcpherson.json`.\n\n**Note:** \"Authors\" is a special metadata reference which will always be within the `metadata.page-details`.\n\n## How does `blacksmith` render my Site?\n\n**It's safe to skip this if you're not tinkering with `blacksmith` internals.** \n\n### Rendering Process\n\nIn order to render list pages with all options supported by `blacksmith` it is necessary to perform multiple rendering passes on a given site to fully render it. Lets examine that process start to finish:\n\n* **1. Rendering starts**\n\nRendering starts when `blacksmith('/full/path/to/your/site', function () { ... })` is invoked. This tells `blacksmith` where the root directory for a given site is.\n\n* **2. Load all HTML and rendering settings**\n\nInside `Site.prototype.load` will load all HTML and rendering settings stored in:\n\n  * .blacksmith\n  * /layouts/*.json || *.html\n  * /pages/*.json\n  * /partials/*.html\n\nWe need to load all of these files before any rendering can begin because they store the necessary settings for rendering.\n\n* **3. Read everything under `/content`**\n\nBefore layout, page, and partial rendering can take place all content (i.e. Markdown and supporting files) must be known to `blacksmith`. In our example how can we render the page represented by `/pages/index.json` without all rendered content? `Site.prototype.readContent` recursively reads `/content` building this data structure:\n\n```\n/content\n  /posts\n    a-post.md\n    another-post.md\n    /dir-post\n      file1.js\n      file2.js\n      index.markdown\n```\n\n``` js\n{\n  posts: {\n    \"a-post\": { _content: { html: \"..\", markdown: \"..\", metadata: { ... } } },\n    \"another-post\": { _content: { html: \"..\", markdown: \"..\", metadata: { ... } } }\n    \"dir-post\": {\n      _content: {\n        html: \"HTML rendered from Markdown\", \n        markdown: \"Markdown in index.markdown\",\n        metadata: {\n          \"page-details\": {\n            source: \"/dir-post/index.markdown\",\n            title: \"Title of page in metadata\" || \"href of page\",\n            date: \"Saturday, November 10, 2012\",\n            href: \"/dir-post\",\n            \"files\": {\n              \"js\": [{ \"filename\": \"file1.js\", \"url\": \"/full/path/to/file1.js\" }],\n              \"img\": [{ \"filename\": \"img1.png\", \"url\": \"/full/path/to/img1.png\" }]\n            }\n          }\n        }\n      },\n      _files: ['file1.js', 'file2.js']\n    }\n  }\n}\n```\n\n* 4. **Render all pages**\n\n### Rendering Data Structure\nAs we discussed `blacksmith` uses hierarchical rendering components. Each component inherits the relevant properties from its parent entity. The full hierarchy is:\n\n* Site\n  * Layout\n    * Partial\n    * Page\n      * Content\n      * Partial\n\nNotice that partials can _be specified by both layouts and pages._ In the event of a conflict the partials specified by the page will always be preferred.\n\nLets examine a fully-formed data structure for rendering each of our rendering data structures:\n\n**Page**\n\n``` js\n  {\n    //\n    // There are all inherited from Site and Layout that this \n    // page is associated with\n    //\n    \"layout\": \"layout-name\"\n    \"html\": {\n      \"layouts\": { ... },\n      \"partials\": { ... }\n    },\n    \"partials\": {\n      \"html-id\": \"sidebar\",\n      \"another-id\": \"breadcrumbs\",\n      \"multiple-partials\": [\"that-can\", \"be-overridden\"]\n    },\n    //\n    // Metadata is extracted from link definitions on the page prefixed,\n    // with \"meta:{key}\". The {key} is what is stored in the metadata property.\n    //\n    // e.g. [meta:author] <> (indexzero)  \n    //\n    \"metadata\": {\n      \"author\": \"indexzero\"\n    }\n  }\n```\n\n## Tests\nAll tests are written with [vows][0] and can be run with [npm][1]:\n\n``` bash\n  $ npm test\n```\n\n## Roadmap\n\n1. RSS Feed\n2. Only render \"dirty\" files (i.e. those not modified since last render).\n3. Customize list sorting by key and direction.\n4. Support nested partials.\n5. Support rendering page depths greater than 1.\n6. Support \"template\" and \"partials\" in layouts.\n7. Investigate this bug: https://github.com/flatiron/plates/issues/93\n\n#### License: MIT\n#### Author: [Charlie Robbins](http://github.com/indexzero)\n\n[0]: http://vowsjs.org\n[1]: http://npmjs.org",
  "readmeFilename": "README.md",
  "_id": "blacksmith@1.1.3",
  "dist": {
    "shasum": "7c0dfe6b45169ed507e58efa06c4a13d5240a909"
  },
  "_from": "blacksmith@~1.1.3",
  "_resolved": "https://registry.npmjs.org/blacksmith/-/blacksmith-1.1.3.tgz"
}
